name: "OS-Specific CodeQL Configuration"

# This configuration file is used by the consolidated-ci-cd.yml workflow
# It provides OS-specific configurations for CodeQL analysis

# Specify paths to analyze
paths:
  # JavaScript/TypeScript paths
  - 'ui'
  - 'sdk/javascript'
  - '**/*.js'
  - '**/*.jsx'
  - '**/*.ts'
  - '**/*.tsx'
  - '**/*.json'
  - '**/*.html'

  # Python paths
  - '**/*.py'
  - '**/*.pyw'
  - '**/*.pyi'

# Paths to exclude
paths-ignore:
  # Virtual environments and dependencies
  - '.venv/**'
  - 'venv/**'
  - 'env/**'
  - '.env/**'
  - '**/virtualenv/**'
  - '**/site-packages/**'
  - '**/dist-packages/**'
  - '**/node_modules/**'
  - '**/dist/**'
  - '**/build/**'
  - '**/vendor/**'
  - '**/external/**'
  - '**/third_party/**'
  - '**/__pycache__/**'
  - '**/.pytest_cache/**'
  - '**/.mypy_cache/**'
  - '**/.ruff_cache/**'
  - '**/*.pyc'
  - '**/*.pyo'
  - '**/*.pyd'

  # Test files
  - '**/test/**'
  - '**/tests/**'
  - '**/__tests__/**'
  - '**/__mocks__/**'
  - '**/*.test.js'
  - '**/*.test.ts'
  - '**/*.test.jsx'
  - '**/*.test.tsx'
  - '**/*.spec.js'
  - '**/*.spec.ts'
  - '**/*.spec.jsx'
  - '**/*.spec.tsx'

  # Configuration files
  - '**/.github/**'
  - '**/.vscode/**'
  - '**/.idea/**'
  - '**/coverage/**'
  - '**/.git/**'

  # Documentation
  - '**/docs/**'
  - '**/*.md'
  - '**/*.mdx'
  - '**/*.rst'
  - '**/sphinx/**'

  # Generated files
  - '**/playwright-report/**'
  - '**/generated/**'

# Query filters
queries:
  # Include the standard security and quality queries
  - uses: security-and-quality

  # Include additional security queries
  - uses: security-extended

  # Include language-specific security queries
  - uses: ./javascript-security-queries.qls
  - uses: ./python-security-queries.qls

# Disable noisy alerts
disable-default-queries: false

# Query suite definitions
query-filters:
  - exclude:
      tags contain: test
  - exclude:
      tags contain: maintainability
      precision below: high
  - exclude:
      tags contain: correctness
      precision below: high

# OS-specific settings
windows:
  # Handle Windows path separators
  path-separator: '\\'
  # Windows-specific file extensions
  additional-extensions:
    - '.bat'
    - '.cmd'
    - '.ps1'

macos:
  # Handle macOS path separators
  path-separator: '/'
  # macOS-specific file extensions
  additional-extensions:
    - '.sh'
    - '.bash'
    - '.zsh'

linux:
  # Handle Linux path separators
  path-separator: '/'
  # Linux-specific file extensions
  additional-extensions:
    - '.sh'
    - '.bash'
    - '.pl'

# Trap errors during extraction
trap-for-errors: true

# Database extraction settings
database:
  # Exclude files that are too large to analyze effectively
  max-file-size-mb: 10
  # Exclude files with too many lines
  max-lines-of-code: 25000
  # Exclude files with too many AST nodes
  max-ast-nodes: 500000
  # Extraction timeout per file
  extraction-timeout: 300
