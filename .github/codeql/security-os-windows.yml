name: "Windows CodeQL Security Configuration"

# This configuration file is used by the consolidated-ci-cd.yml workflow
# It provides Windows-specific configurations for CodeQL analysis

# Specify paths to analyze
paths:
  # JavaScript/TypeScript paths
  - 'ui'
  - 'sdk/javascript'
  - '**/*.js'
  - '**/*.jsx'
  - '**/*.ts'
  - '**/*.tsx'
  - '**/*.json'
  - '**/*.html'
  
  # Python paths
  - '**/*.py'
  - '**/*.pyw'
  - '**/*.pyi'

# Paths to exclude
paths-ignore:
  # Build artifacts
  - '**/node_modules/**'
  - '**/dist/**'
  - '**/build/**'
  - '**/.venv/**'
  - '**/vendor/**'
  - '**/external/**'
  - '**/third_party/**'
  
  # Test files
  - '**/test/**'
  - '**/tests/**'
  - '**/__tests__/**'
  - '**/__mocks__/**'
  - '**/*.test.js'
  - '**/*.test.ts'
  - '**/*.test.jsx'
  - '**/*.test.tsx'
  - '**/*.spec.js'
  - '**/*.spec.ts'
  - '**/*.spec.jsx'
  - '**/*.spec.tsx'
  
  # Configuration files
  - '**/.github/**'
  - '**/.vscode/**'
  - '**/.idea/**'
  - '**/coverage/**'
  
  # Documentation
  - '**/docs/**'
  - '**/*.md'
  - '**/*.mdx'
  - '**/*.rst'
  - '**/sphinx/**'

# Query filters
queries:
  # Include the standard security and quality queries
  - uses: security-and-quality

  # Include additional security queries
  - uses: security-extended

  # Include language-specific security queries
  - uses: ./javascript-security-queries.qls
  - uses: ./python-security-queries.qls

# Disable noisy alerts
disable-default-queries: false

# Query suite definitions
query-filters:
  - exclude:
      tags contain: test
  - exclude:
      tags contain: maintainability
      precision below: high
  - exclude:
      tags contain: correctness
      precision below: high

# Windows-specific settings
windows:
  # Handle Windows path separators
  path-separator: '\\'
  # Windows-specific file extensions
  additional-extensions:
    - '.bat'
    - '.cmd'
    - '.ps1'

# Trap errors during extraction
trap-for-errors: true

# Database extraction settings
database:
  # Exclude files that are too large to analyze effectively
  max-file-size-mb: 10
  # Exclude files with too many lines
  max-lines-of-code: 25000
  # Exclude files with too many AST nodes
  max-ast-nodes: 500000
  # Extraction timeout per file
  extraction-timeout: 300
