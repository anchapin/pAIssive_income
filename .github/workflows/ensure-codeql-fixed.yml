name: Ensure Fixed CodeQL Workflows
true:
  pull_request:
    branches:
    - main
    - dev
    - master
    - develop
    paths:
    - .github/workflows/codeql*.yml
    - .github/scripts/ensure-fixed-codeql-workflows.ps1
    - .github/workflows/ensure-codeql-fixed.yml
  workflow_dispatch: {}
jobs:
  ensure-fixed-codeql:
    runs-on: windows-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
    - name: Ensure fixed CodeQL workflow files
      shell: pwsh
      run: "Write-Host \"Ensuring fixed CodeQL workflow files are used...\"\nif (Test-Path\
        \ \".github/scripts/ensure-fixed-codeql-workflows.ps1\") {\n  Write-Host \"\
        Running ensure-fixed-codeql-workflows.ps1 script...\"\n  ./.github/scripts/ensure-fixed-codeql-workflows.ps1\n\
        } else {\n  Write-Host \"ensure-fixed-codeql-workflows.ps1 script not found,\
        \ skipping...\"\n  exit 1\n}\n"
    - name: Commit changes if needed
      shell: pwsh
      run: "git config --local user.email \"github-actions[bot]@users.noreply.github.com\"\
        \ngit config --local user.name \"github-actions[bot]\"\n\n# Check if there\
        \ are changes to commit\nif (git status --porcelain | Select-String \".github/workflows/codeql\"\
        ) {\n  Write-Host \"Changes detected in CodeQL workflow files. Committing\
        \ changes...\"\n  git add .github/workflows/codeql*.yml\n  git commit -m \"\
        Use fixed CodeQL workflow files [skip ci]\"\n  \n  # Push changes\n  git push\n\
        \  Write-Host \"Changes pushed successfully.\"\n} else {\n  Write-Host \"\
        No changes to commit. CodeQL workflow files are already up to date.\"\n}\n"
    timeout-minutes: 30
'on':
  push:
    branches:
    - main
    - develop
    - master
  pull_request:
    branches:
    - main
    - develop
    - master
  workflow_dispatch: {}
